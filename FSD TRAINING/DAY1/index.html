<!doctype html>
<html lang="en" data-theme="system">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <meta name="color-scheme" content="light dark" />
    <title>Daily Expense Tracker</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <noscript>
      <div class="nojs">This app requires JavaScript to run.</div>
    </noscript>

    <div id="app" class="app">
      <header class="app-header" role="banner">
        <div class="brand">
          <h1 class="app-title">Daily Expense Tracker</h1>
        </div>

        <div class="header-actions">
          <div class="group">
            <button id="themeToggle" class="btn" aria-pressed="false" title="Toggle theme">üåó Theme</button>
            <label for="currencySelect" class="sr-only">Currency</label>
            <select id="currencySelect" class="select" aria-label="Currency">
              <!-- Populated by JS -->
            </select>
          </div>

          <div class="group">
            <input id="fileImport" type="file" accept=".json" class="visually-hidden" />
            <button id="importBtn" class="btn" title="Import JSON">‚¨ÜÔ∏è Import</button>
            <button id="exportJsonBtn" class="btn" title="Export JSON">‚¨áÔ∏è Export JSON</button>
            <button id="exportCsvBtn" class="btn" title="Export CSV">‚¨áÔ∏è Export CSV</button>
          </div>
        </div>
      </header>

      <main class="app-main" id="main" tabindex="-1">
        <section class="panel" id="formPanel" aria-labelledby="formHeading">
          <div class="panel-header">
            <h2 id="formHeading" class="panel-title">Add expense</h2>
            <button id="toggleForm" class="link-btn" aria-expanded="true" aria-controls="expenseForm">Collapse</button>
          </div>

          <form id="expenseForm" class="form" novalidate>
            <input type="hidden" id="expenseId" />

            <div class="form-row">
              <div class="field">
                <label for="title">Title<span class="req">*</span></label>
                <input id="title" name="title" type="text" required maxlength="120" autocomplete="off" />
                <div class="error" id="titleError" role="alert"></div>
              </div>

              <div class="field">
                <label for="amount">Amount<span class="req">*</span></label>
                <input id="amount" name="amount" type="number" step="0.01" min="0" inputmode="decimal" required />
                <div class="hint" id="amountHint">Stored as minor units to avoid floating-point errors.</div>
                <div class="error" id="amountError" role="alert"></div>
              </div>

              <div class="field">
                <label for="category">Category</label>
                <select id="category" name="category">
                  <!-- populated by JS -->
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="field">
                <label for="date">Date</label>
                <input id="date" name="date" type="date" />
                <div class="error" id="dateError" role="alert"></div>
              </div>

              <div class="field">
                <label for="method">Payment method</label>
                <select id="method" name="method">
                  <option>Cash</option>
                  <option>Card</option>
                  <option>UPI</option>
                  <option>Bank Transfer</option>
                  <option>Other</option>
                </select>
              </div>

              <div class="field">
                <label for="notes">Notes</label>
                <textarea id="notes" name="notes" rows="1" maxlength="300"></textarea>
              </div>
            </div>

            <div class="form-actions">
              <button id="submitBtn" type="submit" class="btn primary" disabled>Add</button>
              <button id="cancelEditBtn" type="button" class="btn subtle hidden">Cancel edit</button>
            </div>
          </form>
        </section>

        <section class="panel" id="filtersPanel" aria-labelledby="filtersHeading">
          <div class="panel-header">
            <h2 id="filtersHeading" class="panel-title">Filters</h2>
          </div>

          <div class="filters">
            <div class="toolbar">
              <div class="tool">
                <label class="sr-only" for="searchInput">Search</label>
                <input id="searchInput" type="search" placeholder="Search title or notes" />
              </div>

              <div class="tool">
                <label class="sr-only" for="rangeQuick">Quick range</label>
                <select id="rangeQuick">
                  <option value="all">All time</option>
                  <option value="today">Today</option>
                  <option value="week">This week</option>
                  <option value="month">This month</option>
                  <option value="custom">Custom range</option>
                </select>
              </div>

              <div class="tool" id="customRange" hidden>
                <label class="sr-only" for="startDate">Start</label>
                <input id="startDate" type="date" />
                <span aria-hidden="true">‚Äì</span>
                <label class="sr-only" for="endDate">End</label>
                <input id="endDate" type="date" />
              </div>

              <div class="tool">
                <label class="sr-only" for="categoryFilter">Category</label>
                <select id="categoryFilter" multiple size="1" title="Filter categories">
                  <!-- Populated by JS -->
                </select>
              </div>

              <div class="tool">
                <label class="sr-only" for="methodFilter">Method</label>
                <select id="methodFilter" multiple size="1" title="Filter methods">
                  <option>Cash</option>
                  <option>Card</option>
                  <option>UPI</option>
                  <option>Bank Transfer</option>
                  <option>Other</option>
                </select>
              </div>

              <div class="tool">
                <button id="clearFiltersBtn" class="btn subtle">Clear filters</button>
              </div>
            </div>

            <div id="activeChips" class="chips" aria-live="polite"></div>
          </div>
        </section>

        <section class="panel" id="budgetPanel" aria-labelledby="budgetHeading">
          <div class="panel-header">
            <h2 id="budgetHeading" class="panel-title">Budgets</h2>
            <button id="toggleBudget" class="link-btn" aria-expanded="false" aria-controls="budgetBody">Expand</button>
          </div>
          <div id="budgetBody" class="budget-body" hidden>
            <div class="budget-grid">
              <div class="field">
                <label for="monthlyBudget">Monthly budget</label>
                <input id="monthlyBudget" type="number" step="0.01" min="0" inputmode="decimal" />
              </div>
              <div id="perCategoryBudgets" class="budget-cats">
                <!-- JS renders per-category budgets -->
              </div>
              <div class="form-actions">
                <button id="saveBudgetsBtn" class="btn">Save budgets</button>
              </div>
            </div>
            <div id="budgetProgress" class="budget-progress">
              <!-- JS renders budget progress bars -->
            </div>
          </div>
        </section>

        <section class="panel" id="listPanel" aria-labelledby="listHeading">
          <div class="panel-header">
            <h2 id="listHeading" class="panel-title">Expenses</h2>
            <div class="panel-actions">
              <span id="countInfo" class="muted"></span>
            </div>
          </div>

          <div class="list-wrap">
            <table id="expenseTable" class="table" aria-describedby="countInfo">
              <thead>
                <tr>
                  <th scope="col">Title</th>
                  <th scope="col">Category</th>
                  <th scope="col" data-sort-key="amount" class="sortable">Amount</th>
                  <th scope="col" data-sort-key="date" class="sortable">Date</th>
                  <th scope="col">Method</th>
                  <th scope="col">Actions</th>
                </tr>
              </thead>
              <tbody id="expenseTbody">
                <!-- JS renders rows -->
              </tbody>
            </table>

            <div id="cardList" class="cards" aria-live="polite">
              <!-- JS renders mobile cards -->
            </div>

            <div id="emptyState" class="empty" hidden>
              <p>No expenses yet.</p>
              <button id="addFirstBtn" class="btn primary">Add first expense</button>
            </div>
          </div>
        </section>

        <section class="summary-bar" id="summaryBar" aria-label="Summary totals">
          <div class="sum-item">
            <span class="sum-label">Today</span>
            <span id="totalToday" class="sum-value">‚Äî</span>
          </div>
          <div class="sum-item">
            <span class="sum-label">This week</span>
            <span id="totalWeek" class="sum-value">‚Äî</span>
          </div>
          <div class="sum-item">
            <span class="sum-label">This month</span>
            <span id="totalMonth" class="sum-value">‚Äî</span>
          </div>
          <div class="sum-item">
            <span class="sum-label">Grand total</span>
            <span id="totalAll" class="sum-value">‚Äî</span>
          </div>
        </section>
      </main>

      <footer class="app-footer">
        <div class="footer-actions">
          <button id="clearAllBtn" class="btn danger" data-step="idle">Clear all data</button>
          <button id="loadSampleBtn" class="btn">Load sample data</button>
          <details id="devPanel">
            <summary>Dev</summary>
            <div class="dev-body">
              <button id="seed100Btn" class="btn subtle">Seed 100 random</button>
              <button id="seed1kBtn" class="btn subtle">Seed 1000 random</button>
            </div>
          </details>
        </div>
      </footer>

      <div id="importPreview" class="import-preview" hidden role="dialog" aria-modal="true" aria-labelledby="importTitle">
        <div class="import-card">
          <h3 id="importTitle">Import data</h3>
          <p id="importInfo" class="muted"></p>
          <div id="importSample" class="import-sample"></div>
          <div class="form-actions">
            <button id="mergeImportBtn" class="btn">Merge</button>
            <button id="replaceImportBtn" class="btn danger">Replace</button>
            <button id="cancelImportBtn" class="btn subtle">Cancel</button>
          </div>
        </div>
      </div>

      <div id="toasts" class="toasts" role="status" aria-live="polite" aria-atomic="true"></div>
    </div>

    <script src="app.js" defer></script>
  </body>
</html>
